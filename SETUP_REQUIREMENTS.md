# Setup Requirements for Website Opportunity Scanner

## What You Need to Provide

The scoring system is **already fully implemented** in the code. You just need to provide API keys to make it work.

### Required API Keys

#### 1. **Google PageSpeed Insights API Key** (Required for Website Scoring)
- **Purpose**: Analyzes website performance and generates the PageSpeed score (0-100)
- **How to get it**:
  1. Go to [Google Cloud Console](https://console.cloud.google.com/)
  2. Create a new project or select an existing one
  3. Enable the "PageSpeed Insights API"
  4. Go to "Credentials" → "Create Credentials" → "API Key"
  5. Copy the API key
- **Add to `.env.local`**:
  ```
  PAGESPEED_API_KEY=your_api_key_here
  ```
- **Note**: This API has a free tier (25,000 requests per day). For production use, you may need to enable billing.

#### 2. **Google Places API Key** (Already Required)
- **Purpose**: Search for businesses and get business details
- **Status**: You should already have this set up
- **Add to `.env.local`**:
  ```
  GOOGLE_MAPS_API_KEY=your_api_key_here
  ```
- **Note**: Make sure billing is enabled on your Google Cloud project for Places API to work.

#### 3. **Foursquare Places API Key** (Optional but Recommended)
- **Purpose**: Enriches business data with Foursquare ratings and popularity (used in scoring)
- **How to get it**:
  1. Go to [Foursquare Developer Portal](https://developer.foursquare.com/)
  2. Create an account and a new app
  3. Get your API key from the app dashboard
- **Add to `.env.local`**:
  ```
  FOURSQUARE_API_KEY=your_api_key_here
  ```
- **Note**: If not provided, the Foursquare score will be `null`, and the final score will only use PageSpeed.

## How the Scoring Works

The **Final Score** is calculated as:

```
Final Score = Median(PageSpeed Score, Foursquare Authority Score)
```

### Component Scores:

1. **PageSpeed Score (0-100)**
   - Generated by Google PageSpeed Insights API
   - Measures website performance, mobile-friendliness, and Core Web Vitals
   - Requires: `PAGESPEED_API_KEY`

2. **Foursquare Authority Score (0-100)**
   - Calculated from Foursquare rating (0-10 scale) and popularity
   - Formula: `(rating / 10) * 70 + (popularity / 100) * 30`
   - Requires: `FOURSQUARE_API_KEY`

3. **Final Score (0-100)**
   - **Median** of the two component scores
   - If only one score is available, that score becomes the final score
   - If neither score is available, final score is `null`

### Score Interpretation:

- **0–30**: Actively hurting the business
- **31–60**: Website exists but weak
- **61–80**: Adequate but underperforming
- **81–100**: Strong presence, low priority

## What Happens Without API Keys?

- **Without `PAGESPEED_API_KEY`**: 
  - PageSpeed score will be `null`
  - Final score will only use Foursquare score (if available)
  - If Foursquare is also missing, final score will be `null`

- **Without `FOURSQUARE_API_KEY`**:
  - Foursquare score will be `null`
  - Final score will only use PageSpeed score (if available)
  - If PageSpeed is also missing, final score will be `null`

- **Without both**:
  - Final score will be `null` for all businesses
  - You'll still see business information, but no opportunity scores

## Quick Setup Checklist

1. ✅ Create `.env.local` file in the project root
2. ✅ Add `GOOGLE_MAPS_API_KEY` (required for search)
3. ✅ Add `PAGESPEED_API_KEY` (required for website scoring)
4. ✅ Add `FOURSQUARE_API_KEY` (optional, but recommended for complete scoring)
5. ✅ Restart your development server (`npm run dev`)

## Example `.env.local` File

```env
# Required
GOOGLE_MAPS_API_KEY=AIzaSy...
PAGESPEED_API_KEY=AIzaSy...

# Optional (but recommended)
FOURSQUARE_API_KEY=fsq3...
```

## Testing Your Setup

After adding the API keys:

1. Search for a business (e.g., "dentist in Leeds")
2. Wait for auto-analysis to complete (or click "Analyze Website")
3. Check the score badge - you should see a number between 0-100
4. Click "Show Score Breakdown" to see PageSpeed and Foursquare scores

If scores are still `null`:
- Check your browser console for API errors
- Verify API keys are correct in `.env.local`
- Make sure billing is enabled for Google APIs
- Check API quotas/limits haven't been exceeded

